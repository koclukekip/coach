<section class="container" style="max-width:1000px;margin:24px auto">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
    <h1 style="margin:0">Takvim Planlama</h1>
    <div style="display:flex;gap:8px">
      <a routerLink="/student/conversations" style="padding:8px 16px;border:1px solid #e5e7eb;border-radius:8px;color:#64748b;text-decoration:none;font-weight:600;background:#f8fafc">ğŸ’¬ Sohbet</a>
      <a routerLink="/student/schedule" style="padding:8px 16px;border:1px solid #36786b;border-radius:8px;color:#36786b;text-decoration:none;font-weight:600;background:#f0fdfa">ğŸ“… Takvim</a>
    </div>
  </div>
  
  <div *ngIf="!hasAccepted()" style="text-align:center;padding:40px;color:#64748b;border:1px solid #e5e7eb;border-radius:12px;background:#f8fafc">
    <div style="font-size:48px;margin-bottom:16px">ğŸ“…</div>
    <div style="font-size:18px;font-weight:600;margin-bottom:8px">Randevu Planlamak Ä°Ã§in</div>
    <div>Ã–nce bir koÃ§ ile konuÅŸma baÅŸlatmanÄ±z gerekiyor.</div>
    <div style="margin-top:16px">
      <a routerLink="/student/conversations" style="color:#36786b;text-decoration:none;font-weight:600">Sohbet sayfasÄ±na git â†’</a>
    </div>
  </div>
  
  <div *ngIf="hasAccepted()" style="padding:20px;border:1px solid #e5e7eb;border-radius:12px;background:#fafafa">
    <div style="font-weight:600;margin-bottom:16px;font-size:18px">ğŸ“… Randevu Planlama</div>
    
    <!-- Day picker and 30-min availability -->
    <div style="display:flex;gap:8px;align-items:center;margin-bottom:16px">
      <label style="font-weight:600;color:#374151">Tarih SeÃ§in:</label>
      <input type="date" [min]="monthStart()" [max]="monthEnd()" [value]="selectedDate()" (change)="onDateChange($any($event.target).value)" style="border:1px solid #e5e7eb;border-radius:10px;padding:8px 10px" />
    </div>
    
    <div *ngIf="selectedDate()" style="margin-bottom:20px">
      <div style="font-weight:600;margin-bottom:12px;color:#374151">Uygun Saatler:</div>
      <div style="display:flex;flex-wrap:wrap;gap:8px">
        <ng-container *ngFor="let b of dayGrid()">
          <button *ngIf="b.state==='open'" type="button" (click)="requestHalfHour(b.start, b.end)" style="border:1px solid #bae6fd;border-radius:10px;padding:8px 12px;background:#e0f2fe;cursor:pointer;font-weight:500;transition:all 0.2s;hover:background:#bae6fd">
            {{ b.label }}
          </button>
        </ng-container>
        <div *ngIf="!hasOpenBlocks()" style="color:#94a3b8;font-size:14px;padding:20px;text-align:center;background:#f8fafc;border-radius:8px">
          SeÃ§ili gÃ¼nde uygun 30 dk aralÄ±ÄŸÄ± yok.
        </div>
      </div>
    </div>

    <!-- Existing slots list (status badges) -->
    <div *ngIf="slots().length" style="margin-top:20px">
      <div style="font-weight:600;margin-bottom:12px;color:#374151">Mevcut RandevularÄ±m:</div>
      <div style="display:flex;flex-direction:column;gap:8px">
        <div *ngFor="let sl of slots()" style="display:flex;justify-content:space-between;align-items:center;border:1px solid #e5e7eb;border-radius:10px;padding:12px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
          <div>
            <div style="font-weight:600;color:#374151">{{ sl.title || 'Randevu' }}</div>
            <div style="font-size:14px;color:#64748b;margin-top:4px">{{ formatRange(sl.start, sl.end) }}</div>
          </div>
          <div>
            <span *ngIf="sl.status==='OPEN'" style="font-size:12px;color:#0284c7;background:#e0f2fe;border:1px solid #bae6fd;border-radius:999px;padding:6px 12px;font-weight:500">AÃ§Ä±k</span>
            <span *ngIf="sl.status==='REQUESTED'" style="font-size:12px;color:#92400e;background:#fef3c7;border:1px solid #fde68a;border-radius:999px;padding:6px 12px;font-weight:500">Onay bekliyor</span>
            <span *ngIf="sl.status==='BOOKED'" style="font-size:12px;color:#166534;background:#dcfce7;border:1px solid #bbf7d0;border-radius:999px;padding:6px 12px;font-weight:500">Rezerve edildi</span>
            <span *ngIf="sl.status==='REJECTED'" style="font-size:12px;color:#991b1b;background:#fee2e2;border:1px solid #fecaca;border-radius:999px;padding:6px 12px;font-weight:500">Reddedildi</span>
            <span *ngIf="sl.status==='CANCELLED'" style="font-size:12px;color:#475569;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:999px;padding:6px 12px;font-weight:500">Ä°ptal edildi</span>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="!slots().length" style="margin-top:20px;color:#94a3b8;font-size:14px;text-align:center;padding:20px;background:#f8fafc;border-radius:8px">
      HenÃ¼z bir randevu yok.
    </div>
  </div>
</section>
